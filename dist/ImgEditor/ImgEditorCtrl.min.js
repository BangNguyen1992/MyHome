"use strict";!function(){function e(e){e.setImageFile=function(t){var i=new FileReader;i.onload=function(t){e.image.src=t.target.result},i.readAsDataURL(t.files[0]),e.image.onload=e.resetImage,console.log(t)},e.vignList=[{src:"img/imgEditor/vignette.jpg"},{src:"img/imgEditor/vignette1.jpg"},{src:"img/imgEditor/vignette2.jpg"},{src:"img/imgEditor/vignette3.jpg"},{src:"img/imgEditor/vignette4.jpg"},{src:"img/imgEditor/vignette5.jpg"},{src:"img/imgEditor/vignette6.jpg"},{src:"img/imgEditor/vignette7.jpg"},{src:"img/imgEditor/vignette8.jpg"}],e.init=function(){e.brightness=0,e.contrast=1,e.glossy=0,e.gradientTop="#FFFFFF",e.gradientBottom="#FFFFFF",e.strength=1,e.color={red:127,green:10,blue:10},e.autocontrast=!1,e.vignette=!1,e.canvas=angular.element("#myCanvas")[0],e.ctx=e.canvas.getContext("2d"),e.image=new Image,e.vignImage=new Image},e.init(),e.resetImage=function(){e.canvas.width=e.image.width,e.canvas.height=e.image.height,e.ctx.drawImage(e.image,0,0,e.canvas.width,e.canvas.height),e.vignImage.src=e.vignSrc,e.vignImage.onload=g()},e.selected=0,e.vignSrc=e.vignList[0].src,e.clickImage=function(t,i){e.vignSrc=t,e.selected=i},e.imageAdjust=function(){e.resetImage(),e.imageData=e.ctx.getImageData(0,0,e.image.width,e.image.height),e.pixels=e.imageData.data,e.numPixels=e.imageData.width*e.imageData.height,t(),i(),a(),e.vignette&&n(),e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height),e.ctx.putImageData(e.imageData,0,0)};var t=function(){e.brightInt=parseInt(e.brightness);for(var t=0;t<e.numPixels;t++)e.pixels[4*t]+=e.brightInt,e.pixels[4*t+1]+=e.brightInt,e.pixels[4*t+2]+=e.brightInt},i=function(){e.contrastInt=parseFloat(e.contrast);for(var t=0;t<e.numPixels;t++)e.pixels[4*t]=(e.pixels[4*t]-128)*e.contrastInt+128,e.pixels[4*t+1]=(e.pixels[4*t+1]-128)*e.contrastInt+128,e.pixels[4*t+2]=(e.pixels[4*t+2]-128)*e.contrastInt+128},g=function(){var t=document.createElement("canvas");t.width=e.image.width,t.height=e.image.height;var i=t.getContext("2d");i.drawImage(e.vignImage,0,0,e.vignImage.width,e.vignImage.height,0,0,t.width,t.height),e.vignData=i.getImageData(0,0,t.width,t.height),e.vignPixels=e.vignData.data},n=function(){for(var t=0;t<e.numPixels;t++)e.pixels[4*t]=e.pixels[4*t]*e.vignPixels[4*t]/255,e.pixels[4*t+1]=e.pixels[4*t+1]*e.vignPixels[4*t+1]/255,e.pixels[4*t+2]=e.pixels[4*t+2]*e.vignPixels[4*t+2]/255},a=function(){e.redInt=parseInt(e.color.red),e.greenInt=parseInt(e.color.green),e.blueInt=parseInt(e.color.blue),e.strengthInt=parseInt(e.strength);for(var t=0;t<e.numPixels;t++)e.pixels[4*t]=e.pixels[4*t]+e.color.red*e.strength/100,e.pixels[4*t+1]=e.pixels[4*t+1]+e.color.green*e.strength/100,e.pixels[4*t+2]=e.pixels[4*t+2]+e.color.blue*e.strength/100};e.saveImage=function(){var t=e.canvas.toDataURL("images/png");e.url=t}}angular.module("myApp").controller("ImgEditorCtrl",e),e.$inject=["$scope"]}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkltZ0VkaXRvci9JbWdFZGl0b3JDdHJsLmpzIl0sIm5hbWVzIjpbIiRzY29wZSIsIkltZ0VkaXRvckN0cmwiLCJzZXRJbWFnZUZpbGUiLCJlbGVtZW50IiwicmVhZGVyIiwib25sb2FkIiwiRmlsZVJlYWRlciIsImUiLCJpbWFnZSIsInNyYyIsInRhcmdldCIsInJlc3VsdCIsInJlYWRBc0RhdGFVUkwiLCJmaWxlcyIsImNvbnNvbGUiLCJsb2ciLCJ2aWduTGlzdCIsImF1dG9jb250cmFzdCIsImFuZ3VsYXIiLCJncmFkaWVudEJvdHRvbSIsInN0cmVuZ3RoIiwiY29sb3IiLCJyZWQiLCJyZXNldEltYWdlIiwiYmx1ZSIsIndpZHRoIiwiZHJhd0ltYWdlIiwiSW1hZ2UiLCJpbml0IiwiY2FudmFzIiwiaW1hZ2VBZGp1c3QiLCJoZWlnaHQiLCJpbWFnZURhdGEiLCJnZXRJbWFnZURhdGEiLCJicmlnaHRBZGp1c3QiLCJ2aWduU3JjIiwiY29udHJhc3RBZGp1c3QiLCJyZXNldFZpZ24iLCJzZWxlY3RlZCIsImNsZWFyUmVjdCIsInB1dEltYWdlRGF0YSIsImN0eCIsInBpeGVscyIsIm51bVBpeGVscyIsImkiLCJicmlnaHRJbnQiLCJ0aW50IiwiY29udHJhc3RJbnQiLCJzZXRWaWduZXR0ZSIsImNuIiwiYnJpZ2h0bmVzcyIsImdldENvbnRleHQiLCJwYXJzZUZsb2F0IiwiY29udHJhc3QiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJyZWRJbnQiLCJwYXJzZUludCIsInN0cmVuZ3RoSW50IiwidmlnbkltYWdlIiwidmlnbkRhdGEiLCJ2aWduUGl4ZWxzIiwidXJsIiwiZ3JlZW5JbnQiLCJncmVlbiIsImJsdWVJbnQiLCJzYXZlSW1hZ2UiLCJpbWdBc0RhdGFVcmwiLCJ0b0RhdGFVUkwiLCJtb2R1bGUiLCJjb250cm9sbGVyIiwiJGluamVjdCJdLCJtYXBwaW5ncyI6ImNBQUEsV0FXRUEsU0FBTUMsRUFBTkQsR0FFQ0EsRUFBQUUsYUFBQSxTQUFBQyxH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RCxFQUpEd0QsT0FBQUMsU0FBQXpELEVBQUFxQixNQUFBQyxLQU1BdEIsRUFBQStELFNBQUFOLFNBQUF6RCxFQUFBcUIsTUFBQTJDLE9BMU1GaEUsRUFBQWlFLFFBQUFSLFNBQUF6RCxFQUFBcUIsTUFBQUcsTUFxTEd4QixFQUFPMEQsWUFBY0QsU0FBU3pELEVBQU9vQixVQUNyQyxJQUFLLElBQUl3QixFQUFJLEVBQUdBLEVBQUk1QyxFQUFPMkMsVUFBV0MsSUFDckM1QyxFQUFPMEMsT0FBVyxFQUFKRSxHQUFTNUMsRUFBTzBDLE9BQVcsRUFBSkUsR0FBUzVDLEVBQU9xQixNQUFNQyxJQUFNdEIsRUFBT29CLFNBQVcsSUFDbkZwQixFQUFPMEMsT0FBVyxFQUFKRSxFQUFRLEdBQUs1QyxFQUFPMEMsT0FBVyxFQUFKRSxFQUFRLEdBQUs1QyxFQUFPcUIsTUFBTTJDLE1BQVFoRSxFQUFPb0IsU0FBVyxJQUM3RnBCLEVBQU8wQyxPQUFXLEVBQUpFLEVBQVEsR0FBSzVDLEVBQU8wQyxPQUFXLEVBQUpFLEVBQVEsR0FBSzVDLEVBQU9xQixNQUFNRyxLQUFPeEIsRUFBT29CLFNBQVcsS0FXOUZwQixFQUFPa0UsVUFBWSxXQUNsQixJQUFJQyxFQUFlbkUsRUFBTzZCLE9BQU91QyxVQUFVLGNBQzNDcEUsRUFBTzhELElBQU1LLEdBck1makQsUUFHRW1ELE9BQU8sU0FEVG5ELFdBQ0VtRCxnQkFDQUMsR0FFRnJFLEVBQWNzRSxTQUFXLFVBUDFCIiwiZmlsZSI6IkltZ0VkaXRvci9JbWdFZGl0b3JDdHJsLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7XG5cdCd1c2Ugc3RyaWN0JztcblxuXHRhbmd1bGFyXG5cdFx0Lm1vZHVsZSgnbXlBcHAnKVxuXHRcdC5jb250cm9sbGVyKCdJbWdFZGl0b3JDdHJsJywgSW1nRWRpdG9yQ3RybCk7XG5cblx0SW1nRWRpdG9yQ3RybC4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuXHRmdW5jdGlvbiBJbWdFZGl0b3JDdHJsKCRzY29wZSkge1xuXG5cdFx0JHNjb3BlLnNldEltYWdlRmlsZSA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG5cdFx0XHQvLyAkc2NvcGUuaW5pdCgpO1xuXHRcdFx0Ly8gZ2V0IHRoZSBpbWFnZSBmcm9tIGVsZW1lbnRcblx0XHRcdC8vIHN0YXJ0IHRvIHB1dCB0aGUgZmlsZSBpbnRvIGNhbnZhcyBlbGVtZW50XG5cdFx0XHQvLyBmaWxlUmVhZGVyXG5cdFx0XHQvLyBvbmxvYWQgZXZlbnRcblx0XHRcdHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXHRcdFx0cmVhZGVyLm9ubG9hZCA9IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHRcdC8vc2V0IGltZyBzcmNcblx0XHRcdFx0JHNjb3BlLmltYWdlLnNyYyA9IGUudGFyZ2V0LnJlc3VsdDtcblx0XHRcdH07XG5cdFx0XHRyZWFkZXIucmVhZEFzRGF0YVVSTChlbGVtZW50LmZpbGVzWzBdKTtcblx0XHRcdCRzY29wZS5pbWFnZS5vbmxvYWQgPSAkc2NvcGUucmVzZXRJbWFnZTtcblx0XHRcdGNvbnNvbGUubG9nKGVsZW1lbnQpO1xuXHRcdFx0Ly9cdFx0XHRjb25zb2xlLmxvZyhcImltZ1wiLCAkc2NvcGUuaW1hZ2UpXG5cdFx0fTtcblxuXHRcdCRzY29wZS52aWduTGlzdCA9IFtcblx0XHRcdHtcblx0XHRcdFx0c3JjOiBcImltZy9pbWdFZGl0b3IvdmlnbmV0dGUuanBnXCJcblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdHNyYzogXCJpbWcvaW1nRWRpdG9yL3ZpZ25ldHRlMS5qcGdcIlxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0c3JjOiBcImltZy9pbWdFZGl0b3IvdmlnbmV0dGUyLmpwZ1wiXG5cdFx0XHR9LFxuXHRcdFx0e1xuXHRcdFx0XHRzcmM6IFwiaW1nL2ltZ0VkaXRvci92aWduZXR0ZTMuanBnXCJcblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdHNyYzogXCJpbWcvaW1nRWRpdG9yL3ZpZ25ldHRlNC5qcGdcIlxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0c3JjOiBcImltZy9pbWdFZGl0b3IvdmlnbmV0dGU1LmpwZ1wiXG5cdFx0XHR9LFxuXHRcdFx0e1xuXHRcdFx0XHRzcmM6IFwiaW1nL2ltZ0VkaXRvci92aWduZXR0ZTYuanBnXCJcblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdHNyYzogXCJpbWcvaW1nRWRpdG9yL3ZpZ25ldHRlNy5qcGdcIlxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0c3JjOiBcImltZy9pbWdFZGl0b3IvdmlnbmV0dGU4LmpwZ1wiXG5cdFx0XHR9XG5cdFx0XHRcblx0XHRdXG5cblxuXHRcdCRzY29wZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly8gaW5pdGlhbGl6ZSBkZWZhdWx0IHZhbHVlcyBmb3IgdmFyaWFibGVzXG5cdFx0XHQkc2NvcGUuYnJpZ2h0bmVzcyA9IDA7XG5cdFx0XHQkc2NvcGUuY29udHJhc3QgPSAxO1xuXHRcdFx0JHNjb3BlLmdsb3NzeSA9IDA7XG5cdFx0XHQkc2NvcGUuZ3JhZGllbnRUb3AgPSBcIiNGRkZGRkZcIjtcblx0XHRcdCRzY29wZS5ncmFkaWVudEJvdHRvbSA9IFwiI0ZGRkZGRlwiO1xuXHRcdFx0JHNjb3BlLnN0cmVuZ3RoID0gMTtcblx0XHRcdCRzY29wZS5jb2xvciA9IHtcblx0XHRcdFx0cmVkOiAxMjcsXG5cdFx0XHRcdGdyZWVuOiAxMCxcblx0XHRcdFx0Ymx1ZTogMTBcblx0XHRcdH07XG5cblx0XHRcdCRzY29wZS5hdXRvY29udHJhc3QgPSBmYWxzZTtcblx0XHRcdCRzY29wZS52aWduZXR0ZSA9IGZhbHNlO1xuXHRcdFx0JHNjb3BlLmNhbnZhcyA9IGFuZ3VsYXIuZWxlbWVudCgnI215Q2FudmFzJylbMF07XG5cdFx0XHQkc2NvcGUuY3R4ID0gJHNjb3BlLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuXHRcdFx0JHNjb3BlLmltYWdlID0gbmV3IEltYWdlKCk7XG5cblx0XHRcdCRzY29wZS52aWduSW1hZ2UgPSBuZXcgSW1hZ2UoKTtcblx0XHR9O1xuXG5cdFx0JHNjb3BlLmluaXQoKTtcblxuXHRcdCRzY29wZS5yZXNldEltYWdlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly8gd2hlbiBpbWFnZSBkYXRlIGlzIGxvYWRlZCwgKGFmdGVyIG9uIGxvYWQpXG5cdFx0XHQvLyBwdXQgdGhlIGRhdGEgaW50byBjYW52YXMgZWxlbWVudFxuXHRcdFx0Ly8gUmVhZCBwaXhlbCBkYXRhXG5cblx0XHRcdC8vIFNldCBzaXplIHRvIG1hdGNoIGNhbnZhcyBzaXplXG5cdFx0XHQkc2NvcGUuY2FudmFzLndpZHRoID0gJHNjb3BlLmltYWdlLndpZHRoO1xuXHRcdFx0JHNjb3BlLmNhbnZhcy5oZWlnaHQgPSAkc2NvcGUuaW1hZ2UuaGVpZ2h0O1xuXG5cdFx0XHQkc2NvcGUuY3R4LmRyYXdJbWFnZSgkc2NvcGUuaW1hZ2UsIDAsIDAsICRzY29wZS5jYW52YXMud2lkdGgsICRzY29wZS5jYW52YXMuaGVpZ2h0KTtcblxuXHRcdFx0Ly8gTG9hZCB2aWduZXR0ZSBpbWFnZVx0XG5cdFx0XHQkc2NvcGUudmlnbkltYWdlLnNyYyA9ICRzY29wZS52aWduU3JjO1xuXHRcdFx0JHNjb3BlLnZpZ25JbWFnZS5vbmxvYWQgPSByZXNldFZpZ24oKTtcblxuXHRcdH07XG5cblx0XHQvL0RlZmF1bHQgc3R5bGVcblx0XHQkc2NvcGUuc2VsZWN0ZWQgPSAwO1xuXHRcdCRzY29wZS52aWduU3JjID0gJHNjb3BlLnZpZ25MaXN0WzBdLnNyYztcblxuXHRcdCRzY29wZS5jbGlja0ltYWdlID0gZnVuY3Rpb24gKHNyYywgaW5kZXgpIHtcblx0XHRcdCRzY29wZS52aWduU3JjID0gc3JjO1xuXHRcdFx0JHNjb3BlLnNlbGVjdGVkID0gaW5kZXg7XG5cdFx0fVxuXG5cdFx0JHNjb3BlLmltYWdlQWRqdXN0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0JHNjb3BlLnJlc2V0SW1hZ2UoKTtcblx0XHRcdCRzY29wZS5pbWFnZURhdGEgPSAkc2NvcGUuY3R4LmdldEltYWdlRGF0YSgwLCAwLCAkc2NvcGUuaW1hZ2Uud2lkdGgsICRzY29wZS5pbWFnZS5oZWlnaHQpO1xuXHRcdFx0JHNjb3BlLnBpeGVscyA9ICRzY29wZS5pbWFnZURhdGEuZGF0YTtcblx0XHRcdCRzY29wZS5udW1QaXhlbHMgPSAkc2NvcGUuaW1hZ2VEYXRhLndpZHRoICogJHNjb3BlLmltYWdlRGF0YS5oZWlnaHQ7XG5cblx0XHRcdGJyaWdodEFkanVzdCgpO1xuXHRcdFx0Y29udHJhc3RBZGp1c3QoKTtcblx0XHRcdHRpbnQoKTtcblxuXG5cdFx0XHRpZiAoJHNjb3BlLnZpZ25ldHRlKSB7XG5cdFx0XHRcdHNldFZpZ25ldHRlKCk7XG5cdFx0XHR9XG5cdFx0XHQvL0NsZWFyIHRoZSByZWN0YW5nbGUgZXF1YWwgdG8gY2FudmFzIHNpemVcblx0XHRcdCRzY29wZS5jdHguY2xlYXJSZWN0KDAsIDAsICRzY29wZS5jYW52YXMud2lkdGgsICRzY29wZS5jYW52YXMuaGVpZ2h0KTtcblxuXHRcdFx0Ly9yZS1kaXNwbGF5IGltZyBhZnRlciBhZGp1c3Rcblx0XHRcdCRzY29wZS5jdHgucHV0SW1hZ2VEYXRhKCRzY29wZS5pbWFnZURhdGEsIDAsIDApO1xuXHRcdH07XG5cblxuXHRcdHZhciBicmlnaHRBZGp1c3QgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQkc2NvcGUuYnJpZ2h0SW50ID0gcGFyc2VJbnQoJHNjb3BlLmJyaWdodG5lc3MpO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAkc2NvcGUubnVtUGl4ZWxzOyBpKyspIHtcblx0XHRcdFx0JHNjb3BlLnBpeGVsc1tpICogNF0gKz0gJHNjb3BlLmJyaWdodEludDtcblx0XHRcdFx0JHNjb3BlLnBpeGVsc1tpICogNCArIDFdICs9ICRzY29wZS5icmlnaHRJbnQ7XG5cdFx0XHRcdCRzY29wZS5waXhlbHNbaSAqIDQgKyAyXSArPSAkc2NvcGUuYnJpZ2h0SW50O1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHR2YXIgY29udHJhc3RBZGp1c3QgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQkc2NvcGUuY29udHJhc3RJbnQgPSBwYXJzZUZsb2F0KCRzY29wZS5jb250cmFzdCk7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS5udW1QaXhlbHM7IGkrKykge1xuXHRcdFx0XHQkc2NvcGUucGl4ZWxzW2kgKiA0XSA9ICgkc2NvcGUucGl4ZWxzW2kgKiA0XSAtIDEyOCkgKiAkc2NvcGUuY29udHJhc3RJbnQgKyAxMjg7XG5cdFx0XHRcdCRzY29wZS5waXhlbHNbaSAqIDQgKyAxXSA9ICgkc2NvcGUucGl4ZWxzW2kgKiA0ICsgMV0gLSAxMjgpICogJHNjb3BlLmNvbnRyYXN0SW50ICsgMTI4O1xuXHRcdFx0XHQkc2NvcGUucGl4ZWxzW2kgKiA0ICsgMl0gPSAoJHNjb3BlLnBpeGVsc1tpICogNCArIDJdIC0gMTI4KSAqICRzY29wZS5jb250cmFzdEludCArIDEyODtcblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0dmFyIHJlc2V0VmlnbiA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHZhciBjbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuXHRcdFx0Ly8gTWFrZSB0aGUgY24gdGhlIHNhbWUgd2lkdGggYWRuZCBoZWlnaHQgYXMgdGhlIHNhbWUgaW1hZ2Vcblx0XHRcdGNuLndpZHRoID0gJHNjb3BlLmltYWdlLndpZHRoO1xuXHRcdFx0Y24uaGVpZ2h0ID0gJHNjb3BlLmltYWdlLmhlaWdodDtcblxuXHRcdFx0Ly8gR2V0IHRoZSBjb250ZXh0IG9mIGNuICAgICAgICAgICAgXG5cdFx0XHR2YXIgY3R4ID0gY24uZ2V0Q29udGV4dCgnMmQnKTtcblxuXHRcdFx0Ly8gRHJhdyB0aGUgdmlnbmV0dGUgaW1hZ2UgdG8gY3R4XG5cdFx0XHRjdHguZHJhd0ltYWdlKCRzY29wZS52aWduSW1hZ2UsIDAsIDAsICRzY29wZS52aWduSW1hZ2Uud2lkdGgsICRzY29wZS52aWduSW1hZ2UuaGVpZ2h0LCAwLCAwLCBjbi53aWR0aCwgY24uaGVpZ2h0KTtcblx0XHRcdCRzY29wZS52aWduRGF0YSA9IGN0eC5nZXRJbWFnZURhdGEoMCwgMCwgY24ud2lkdGgsIGNuLmhlaWdodCk7IC8vIEdldCB0aGUgaW1hZ2UgZGF0YSBvZiB0aGUgdmlnbmV0dGVcblx0XHRcdCRzY29wZS52aWduUGl4ZWxzID0gJHNjb3BlLnZpZ25EYXRhLmRhdGE7IC8vIEdldCB0aGUgcGl4ZWxzIGZyb20gaW1hZ2VEQVRBXG5cdFx0fTtcblxuXHRcdHZhciBzZXRWaWduZXR0ZSA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdC8vXHRcdFx0Y29uc29sZS5sb2coJHNjb3BlLnZpZ25EYXRhLmRhdGEpO1xuXHRcdFx0Ly8gUG8gPSBQaSArIFB2IC8yNTU7ICBcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgJHNjb3BlLm51bVBpeGVsczsgaSsrKSB7XG5cdFx0XHRcdCRzY29wZS5waXhlbHNbaSAqIDRdID0gJHNjb3BlLnBpeGVsc1tpICogNF0gKiAkc2NvcGUudmlnblBpeGVsc1tpICogNF0gLyAyNTU7IC8vIFJlZFxuXHRcdFx0XHQkc2NvcGUucGl4ZWxzW2kgKiA0ICsgMV0gPSAkc2NvcGUucGl4ZWxzW2kgKiA0ICsgMV0gKiAkc2NvcGUudmlnblBpeGVsc1tpICogNCArIDFdIC8gMjU1OyAvLyBHcmVlblxuXHRcdFx0XHQkc2NvcGUucGl4ZWxzW2kgKiA0ICsgMl0gPSAkc2NvcGUucGl4ZWxzW2kgKiA0ICsgMl0gKiAkc2NvcGUudmlnblBpeGVsc1tpICogNCArIDJdIC8gMjU1OyAvLyBCbHVlXG5cblx0XHRcdH1cblx0XHR9O1xuXG5cdFx0dmFyIHRpbnQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQkc2NvcGUucmVkSW50ID0gcGFyc2VJbnQoJHNjb3BlLmNvbG9yLnJlZCk7XG5cdFx0XHQkc2NvcGUuZ3JlZW5JbnQgPSBwYXJzZUludCgkc2NvcGUuY29sb3IuZ3JlZW4pO1xuXHRcdFx0JHNjb3BlLmJsdWVJbnQgPSBwYXJzZUludCgkc2NvcGUuY29sb3IuYmx1ZSk7XG5cdFx0XHQkc2NvcGUuc3RyZW5ndGhJbnQgPSBwYXJzZUludCgkc2NvcGUuc3RyZW5ndGgpO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAkc2NvcGUubnVtUGl4ZWxzOyBpKyspIHtcblx0XHRcdFx0JHNjb3BlLnBpeGVsc1tpICogNF0gPSAkc2NvcGUucGl4ZWxzW2kgKiA0XSArICRzY29wZS5jb2xvci5yZWQgKiAkc2NvcGUuc3RyZW5ndGggLyAxMDA7IC8vIFJlZFxuXHRcdFx0XHQkc2NvcGUucGl4ZWxzW2kgKiA0ICsgMV0gPSAkc2NvcGUucGl4ZWxzW2kgKiA0ICsgMV0gKyAkc2NvcGUuY29sb3IuZ3JlZW4gKiAkc2NvcGUuc3RyZW5ndGggLyAxMDA7IC8vIEdyZWVuXG5cdFx0XHRcdCRzY29wZS5waXhlbHNbaSAqIDQgKyAyXSA9ICRzY29wZS5waXhlbHNbaSAqIDQgKyAyXSArICRzY29wZS5jb2xvci5ibHVlICogJHNjb3BlLnN0cmVuZ3RoIC8gMTAwOyAvLyBCbHVlXG5cblx0XHRcdH1cblx0XHR9O1xuXG5cblx0XHQvL1x0XHQkc2NvcGUuc2VsZWN0ID0gZnVuY3Rpb24gKGluZGV4KSB7XG5cdFx0Ly9cdFx0XHQkc2NvcGUuc2VsZWN0ZWQgPSBpbmRleDtcblx0XHQvL1x0XHR9O1xuXG5cblx0XHQkc2NvcGUuc2F2ZUltYWdlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0dmFyIGltZ0FzRGF0YVVybCA9ICRzY29wZS5jYW52YXMudG9EYXRhVVJMKCdpbWFnZXMvcG5nJyk7XG5cdFx0XHQkc2NvcGUudXJsID0gaW1nQXNEYXRhVXJsO1xuXG5cdFx0fTtcblxuXHR9XG59KSgpOyJdfQ==
