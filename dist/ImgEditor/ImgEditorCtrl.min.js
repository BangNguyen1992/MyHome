"use strict";!function(){function e(e){e.setImageFile=function(t){var i=new FileReader;i.onload=function(t){e.image.src=t.target.result},i.readAsDataURL(t.files[0]),e.image.onload=e.resetImage,console.log(t)},e.vignList=[{src:"img/imgEditor/vignette.jpg"},{src:"img/imgEditor/vignette1.jpg"},{src:"img/imgEditor/vignette2.jpg"},{src:"img/imgEditor/vignette3.jpg"},{src:"img/imgEditor/vignette4.jpg"},{src:"img/imgEditor/vignette5.jpg"},{src:"img/imgEditor/vignette6.jpg"},{src:"img/imgEditor/vignette7.jpg"},{src:"img/imgEditor/vignette8.jpg"}],e.init=function(){e.brightness=0,e.contrast=1,e.glossy=0,e.gradientTop="#FFFFFF",e.gradientBottom="#FFFFFF",e.strength=1,e.color={red:127,green:10,blue:10},e.autocontrast=!1,e.vignette=!1,e.canvas=angular.element("#myCanvas")[0],e.ctx=e.canvas.getContext("2d"),e.image=new Image,e.vignImage=new Image},e.init(),e.resetImage=function(){e.canvas.width=e.image.width,e.canvas.height=e.image.height,e.ctx.drawImage(e.image,0,0,e.canvas.width,e.canvas.height),e.vignImage.src=e.vignSrc,e.vignImage.onload=g()},e.selected=0,e.vignSrc=e.vignList[0].src,e.clickImage=function(t,i){e.vignSrc=t,e.selected=i},e.imageAdjust=function(){e.resetImage(),e.imageData=e.ctx.getImageData(0,0,e.image.width,e.image.height),e.pixels=e.imageData.data,e.numPixels=e.imageData.width*e.imageData.height,t(),i(),a(),e.vignette&&n(),e.ctx.clearRect(0,0,e.canvas.width,e.canvas.height),e.ctx.putImageData(e.imageData,0,0)};var t=function(){e.brightInt=parseInt(e.brightness);for(var t=0;t<e.numPixels;t++)e.pixels[4*t]+=e.brightInt,e.pixels[4*t+1]+=e.brightInt,e.pixels[4*t+2]+=e.brightInt},i=function(){e.contrastInt=parseFloat(e.contrast);for(var t=0;t<e.numPixels;t++)e.pixels[4*t]=(e.pixels[4*t]-128)*e.contrastInt+128,e.pixels[4*t+1]=(e.pixels[4*t+1]-128)*e.contrastInt+128,e.pixels[4*t+2]=(e.pixels[4*t+2]-128)*e.contrastInt+128},g=function(){var t=document.createElement("canvas");t.width=e.image.width,t.height=e.image.height;var i=t.getContext("2d");i.drawImage(e.vignImage,0,0,e.vignImage.width,e.vignImage.height,0,0,t.width,t.height),e.vignData=i.getImageData(0,0,t.width,t.height),e.vignPixels=e.vignData.data},n=function(){for(var t=0;t<e.numPixels;t++)e.pixels[4*t]=e.pixels[4*t]*e.vignPixels[4*t]/255,e.pixels[4*t+1]=e.pixels[4*t+1]*e.vignPixels[4*t+1]/255,e.pixels[4*t+2]=e.pixels[4*t+2]*e.vignPixels[4*t+2]/255},a=function(){e.redInt=parseInt(e.color.red),e.greenInt=parseInt(e.color.green),e.blueInt=parseInt(e.color.blue),e.strengthInt=parseInt(e.strength);for(var t=0;t<e.numPixels;t++)e.pixels[4*t]=e.pixels[4*t]+e.color.red*e.strength/100,e.pixels[4*t+1]=e.pixels[4*t+1]+e.color.green*e.strength/100,e.pixels[4*t+2]=e.pixels[4*t+2]+e.color.blue*e.strength/100};e.saveImage=function(){var t=e.canvas.toDataURL("images/png");e.url=t}}angular.module("myApp").controller("ImgEditorCtrl",e),e.$inject=["$scope"]}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkltZ0VkaXRvci9JbWdFZGl0b3JDdHJsLmpzIl0sIm5hbWVzIjpbIkltZ0VkaXRvckN0cmwiLCIkc2NvcGUiLCJzZXRJbWFnZUZpbGUiLCJlbGVtZW50IiwicmVhZGVyIiwiRmlsZVJlYWRlciIsIm9ubG9hZCIsImUiLCJpbWFnZSIsInNyYyIsInRhcmdldCIsInJlc3VsdCIsInJlYWRBc0RhdGFVUkwiLCJmaWxlcyIsInJlc2V0SW1hZ2UiLCJjb25zb2xlIiwibG9nIiwidmlnbkxpc3QiLCJpbml0IiwiYnJpZ2h0bmVzcyIsImNvbnRyYXN0IiwiZ2xvc3N5IiwiZ3JhZGllbnRUb3AiLCJncmFkaWVudEJvdHRvbSIsInN0cmVuZ3RoIiwiY29sb3IiLCJyZWQiLCJncmVlbiIsImJsdWUiLCJhdXRvY29udHJhc3QiLCJ2aWduZXR0ZSIsImNhbnZhcyIsImFuZ3VsYXIiLCJjdHgiLCJnZXRDb250ZXh0IiwiSW1hZ2UiLCJ2aWduSW1hZ2UiLCJ3aWR0aCIsImhlaWdodCIsImRyYXdJbWFnZSIsInZpZ25TcmMiLCJyZXNldFZpZ24iLCJzZWxlY3RlZCIsImNsaWNrSW1hZ2UiLCJpbmRleCIsImltYWdlQWRqdXN0IiwiaW1hZ2VEYXRhIiwiZ2V0SW1hZ2VEYXRhIiwicGl4ZWxzIiwiZGF0YSIsIm51bVBpeGVscyIsImJyaWdodEFkanVzdCIsImNvbnRyYXN0QWRqdXN0IiwidGludCIsInNldFZpZ25ldHRlIiwiY2xlYXJSZWN0IiwicHV0SW1hZ2VEYXRhIiwiYnJpZ2h0SW50IiwicGFyc2VJbnQiLCJpIiwiY29udHJhc3RJbnQiLCJwYXJzZUZsb2F0IiwiY24iLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJ2aWduRGF0YSIsInZpZ25QaXhlbHMiLCJyZWRJbnQiLCJncmVlbkludCIsImJsdWVJbnQiLCJzdHJlbmd0aEludCIsInNhdmVJbWFnZSIsImltZ0FzRGF0YVVybCIsInRvRGF0YVVSTCIsInVybCIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkaW5qZWN0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LEVBQU9pRSxXQUFlLEVBQUpQLEVBQVEsR0FBSyxLQUtuRk4sRUFBTyxXQUNWcEQsRUFBT2tFLE9BQVNULFNBQVN6RCxFQUFPd0IsTUFBTUMsS0FDdEN6QixFQUFPbUUsU0FBV1YsU0FBU3pELEVBQU93QixNQUFNRSxPQUN4QzFCLEVBQU9vRSxRQUFVWCxTQUFTekQsRUFBT3dCLE1BQU1HLE1BQ3ZDM0IsRUFBT3FFLFlBQWNaLFNBQVN6RCxFQUFPdUIsU0FDckMsS0FBSyxHQUFJbUMsR0FBSSxFQUFHQSxFQUFJMUQsRUFBT2lELFVBQVdTLElBQ3JDMUQsRUFBTytDLE9BQVcsRUFBSlcsR0FBUzFELEVBQU8rQyxPQUFXLEVBQUpXLEdBQVMxRCxFQUFPd0IsTUFBTUMsSUFBTXpCLEVBQU91QixTQUFXLElBQ25GdkIsRUFBTytDLE9BQVcsRUFBSlcsRUFBUSxHQUFLMUQsRUFBTytDLE9BQVcsRUFBSlcsRUFBUSxHQUFLMUQsRUFBT3dCLE1BQU1FLE1BQVExQixFQUFPdUIsU0FBVyxJQUM3RnZCLEVBQU8rQyxPQUFXLEVBQUpXLEVBQVEsR0FBSzFELEVBQU8rQyxPQUFXLEVBQUpXLEVBQVEsR0FBSzFELEVBQU93QixNQUFNRyxLQUFPM0IsRUFBT3VCLFNBQVcsSUFXOUZ2QixHQUFPc0UsVUFBWSxXQUNsQixHQUFJQyxHQUFldkUsRUFBTzhCLE9BQU8wQyxVQUFVLGFBQzNDeEUsR0FBT3lFLElBQU1GLEdBbk1meEMsUUFDRTJDLE9BQU8sU0FDUEMsV0FBVyxnQkFBaUI1RSxHQUU5QkEsRUFBYzZFLFNBQVciLCJmaWxlIjoiSW1nRWRpdG9yL0ltZ0VkaXRvckN0cmwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG5cdGFuZ3VsYXJcblx0XHQubW9kdWxlKCdteUFwcCcpXG5cdFx0LmNvbnRyb2xsZXIoJ0ltZ0VkaXRvckN0cmwnLCBJbWdFZGl0b3JDdHJsKTtcblxuXHRJbWdFZGl0b3JDdHJsLiRpbmplY3QgPSBbJyRzY29wZSddO1xuXG5cdGZ1bmN0aW9uIEltZ0VkaXRvckN0cmwoJHNjb3BlKSB7XG5cblx0XHQkc2NvcGUuc2V0SW1hZ2VGaWxlID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcblx0XHRcdC8vICRzY29wZS5pbml0KCk7XG5cdFx0XHQvLyBnZXQgdGhlIGltYWdlIGZyb20gZWxlbWVudFxuXHRcdFx0Ly8gc3RhcnQgdG8gcHV0IHRoZSBmaWxlIGludG8gY2FudmFzIGVsZW1lbnRcblx0XHRcdC8vIGZpbGVSZWFkZXJcblx0XHRcdC8vIG9ubG9hZCBldmVudFxuXHRcdFx0dmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG5cdFx0XHRyZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcblx0XHRcdFx0Ly9zZXQgaW1nIHNyY1xuXHRcdFx0XHQkc2NvcGUuaW1hZ2Uuc3JjID0gZS50YXJnZXQucmVzdWx0O1xuXHRcdFx0fTtcblx0XHRcdHJlYWRlci5yZWFkQXNEYXRhVVJMKGVsZW1lbnQuZmlsZXNbMF0pO1xuXHRcdFx0JHNjb3BlLmltYWdlLm9ubG9hZCA9ICRzY29wZS5yZXNldEltYWdlO1xuXHRcdFx0Y29uc29sZS5sb2coZWxlbWVudCk7XG5cdFx0XHQvL1x0XHRcdGNvbnNvbGUubG9nKFwiaW1nXCIsICRzY29wZS5pbWFnZSlcblx0XHR9O1xuXG5cdFx0JHNjb3BlLnZpZ25MaXN0ID0gW1xuXHRcdFx0e1xuXHRcdFx0XHRzcmM6IFwiaW1nL2ltZ0VkaXRvci92aWduZXR0ZS5qcGdcIlxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0c3JjOiBcImltZy9pbWdFZGl0b3IvdmlnbmV0dGUxLmpwZ1wiXG5cdFx0XHR9LFxuXHRcdFx0e1xuXHRcdFx0XHRzcmM6IFwiaW1nL2ltZ0VkaXRvci92aWduZXR0ZTIuanBnXCJcblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdHNyYzogXCJpbWcvaW1nRWRpdG9yL3ZpZ25ldHRlMy5qcGdcIlxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0c3JjOiBcImltZy9pbWdFZGl0b3IvdmlnbmV0dGU0LmpwZ1wiXG5cdFx0XHR9LFxuXHRcdFx0e1xuXHRcdFx0XHRzcmM6IFwiaW1nL2ltZ0VkaXRvci92aWduZXR0ZTUuanBnXCJcblx0XHRcdH0sXG5cdFx0XHR7XG5cdFx0XHRcdHNyYzogXCJpbWcvaW1nRWRpdG9yL3ZpZ25ldHRlNi5qcGdcIlxuXHRcdFx0fSxcblx0XHRcdHtcblx0XHRcdFx0c3JjOiBcImltZy9pbWdFZGl0b3IvdmlnbmV0dGU3LmpwZ1wiXG5cdFx0XHR9LFxuXHRcdFx0e1xuXHRcdFx0XHRzcmM6IFwiaW1nL2ltZ0VkaXRvci92aWduZXR0ZTguanBnXCJcblx0XHRcdH1cblx0XHRcdFxuXHRcdF1cblxuXG5cdFx0JHNjb3BlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQvLyBpbml0aWFsaXplIGRlZmF1bHQgdmFsdWVzIGZvciB2YXJpYWJsZXNcblx0XHRcdCRzY29wZS5icmlnaHRuZXNzID0gMDtcblx0XHRcdCRzY29wZS5jb250cmFzdCA9IDE7XG5cdFx0XHQkc2NvcGUuZ2xvc3N5ID0gMDtcblx0XHRcdCRzY29wZS5ncmFkaWVudFRvcCA9IFwiI0ZGRkZGRlwiO1xuXHRcdFx0JHNjb3BlLmdyYWRpZW50Qm90dG9tID0gXCIjRkZGRkZGXCI7XG5cdFx0XHQkc2NvcGUuc3RyZW5ndGggPSAxO1xuXHRcdFx0JHNjb3BlLmNvbG9yID0ge1xuXHRcdFx0XHRyZWQ6IDEyNyxcblx0XHRcdFx0Z3JlZW46IDEwLFxuXHRcdFx0XHRibHVlOiAxMFxuXHRcdFx0fTtcblxuXHRcdFx0JHNjb3BlLmF1dG9jb250cmFzdCA9IGZhbHNlO1xuXHRcdFx0JHNjb3BlLnZpZ25ldHRlID0gZmFsc2U7XG5cdFx0XHQkc2NvcGUuY2FudmFzID0gYW5ndWxhci5lbGVtZW50KCcjbXlDYW52YXMnKVswXTtcblx0XHRcdCRzY29wZS5jdHggPSAkc2NvcGUuY2FudmFzLmdldENvbnRleHQoJzJkJyk7XG5cdFx0XHQkc2NvcGUuaW1hZ2UgPSBuZXcgSW1hZ2UoKTtcblxuXHRcdFx0JHNjb3BlLnZpZ25JbWFnZSA9IG5ldyBJbWFnZSgpO1xuXHRcdH07XG5cblx0XHQkc2NvcGUuaW5pdCgpO1xuXG5cdFx0JHNjb3BlLnJlc2V0SW1hZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQvLyB3aGVuIGltYWdlIGRhdGUgaXMgbG9hZGVkLCAoYWZ0ZXIgb24gbG9hZClcblx0XHRcdC8vIHB1dCB0aGUgZGF0YSBpbnRvIGNhbnZhcyBlbGVtZW50XG5cdFx0XHQvLyBSZWFkIHBpeGVsIGRhdGFcblxuXHRcdFx0Ly8gU2V0IHNpemUgdG8gbWF0Y2ggY2FudmFzIHNpemVcblx0XHRcdCRzY29wZS5jYW52YXMud2lkdGggPSAkc2NvcGUuaW1hZ2Uud2lkdGg7XG5cdFx0XHQkc2NvcGUuY2FudmFzLmhlaWdodCA9ICRzY29wZS5pbWFnZS5oZWlnaHQ7XG5cblx0XHRcdCRzY29wZS5jdHguZHJhd0ltYWdlKCRzY29wZS5pbWFnZSwgMCwgMCwgJHNjb3BlLmNhbnZhcy53aWR0aCwgJHNjb3BlLmNhbnZhcy5oZWlnaHQpO1xuXG5cdFx0XHQvLyBMb2FkIHZpZ25ldHRlIGltYWdlXHRcblx0XHRcdCRzY29wZS52aWduSW1hZ2Uuc3JjID0gJHNjb3BlLnZpZ25TcmM7XG5cdFx0XHQkc2NvcGUudmlnbkltYWdlLm9ubG9hZCA9IHJlc2V0VmlnbigpO1xuXG5cdFx0fTtcblxuXHRcdC8vRGVmYXVsdCBzdHlsZVxuXHRcdCRzY29wZS5zZWxlY3RlZCA9IDA7XG5cdFx0JHNjb3BlLnZpZ25TcmMgPSAkc2NvcGUudmlnbkxpc3RbMF0uc3JjO1xuXG5cdFx0JHNjb3BlLmNsaWNrSW1hZ2UgPSBmdW5jdGlvbiAoc3JjLCBpbmRleCkge1xuXHRcdFx0JHNjb3BlLnZpZ25TcmMgPSBzcmM7XG5cdFx0XHQkc2NvcGUuc2VsZWN0ZWQgPSBpbmRleDtcblx0XHR9XG5cblx0XHQkc2NvcGUuaW1hZ2VBZGp1c3QgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQkc2NvcGUucmVzZXRJbWFnZSgpO1xuXHRcdFx0JHNjb3BlLmltYWdlRGF0YSA9ICRzY29wZS5jdHguZ2V0SW1hZ2VEYXRhKDAsIDAsICRzY29wZS5pbWFnZS53aWR0aCwgJHNjb3BlLmltYWdlLmhlaWdodCk7XG5cdFx0XHQkc2NvcGUucGl4ZWxzID0gJHNjb3BlLmltYWdlRGF0YS5kYXRhO1xuXHRcdFx0JHNjb3BlLm51bVBpeGVscyA9ICRzY29wZS5pbWFnZURhdGEud2lkdGggKiAkc2NvcGUuaW1hZ2VEYXRhLmhlaWdodDtcblxuXHRcdFx0YnJpZ2h0QWRqdXN0KCk7XG5cdFx0XHRjb250cmFzdEFkanVzdCgpO1xuXHRcdFx0dGludCgpO1xuXG5cblx0XHRcdGlmICgkc2NvcGUudmlnbmV0dGUpIHtcblx0XHRcdFx0c2V0VmlnbmV0dGUoKTtcblx0XHRcdH1cblx0XHRcdC8vQ2xlYXIgdGhlIHJlY3RhbmdsZSBlcXVhbCB0byBjYW52YXMgc2l6ZVxuXHRcdFx0JHNjb3BlLmN0eC5jbGVhclJlY3QoMCwgMCwgJHNjb3BlLmNhbnZhcy53aWR0aCwgJHNjb3BlLmNhbnZhcy5oZWlnaHQpO1xuXG5cdFx0XHQvL3JlLWRpc3BsYXkgaW1nIGFmdGVyIGFkanVzdFxuXHRcdFx0JHNjb3BlLmN0eC5wdXRJbWFnZURhdGEoJHNjb3BlLmltYWdlRGF0YSwgMCwgMCk7XG5cdFx0fTtcblxuXG5cdFx0dmFyIGJyaWdodEFkanVzdCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdCRzY29wZS5icmlnaHRJbnQgPSBwYXJzZUludCgkc2NvcGUuYnJpZ2h0bmVzcyk7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS5udW1QaXhlbHM7IGkrKykge1xuXHRcdFx0XHQkc2NvcGUucGl4ZWxzW2kgKiA0XSArPSAkc2NvcGUuYnJpZ2h0SW50O1xuXHRcdFx0XHQkc2NvcGUucGl4ZWxzW2kgKiA0ICsgMV0gKz0gJHNjb3BlLmJyaWdodEludDtcblx0XHRcdFx0JHNjb3BlLnBpeGVsc1tpICogNCArIDJdICs9ICRzY29wZS5icmlnaHRJbnQ7XG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdHZhciBjb250cmFzdEFkanVzdCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdCRzY29wZS5jb250cmFzdEludCA9IHBhcnNlRmxvYXQoJHNjb3BlLmNvbnRyYXN0KTtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgJHNjb3BlLm51bVBpeGVsczsgaSsrKSB7XG5cdFx0XHRcdCRzY29wZS5waXhlbHNbaSAqIDRdID0gKCRzY29wZS5waXhlbHNbaSAqIDRdIC0gMTI4KSAqICRzY29wZS5jb250cmFzdEludCArIDEyODtcblx0XHRcdFx0JHNjb3BlLnBpeGVsc1tpICogNCArIDFdID0gKCRzY29wZS5waXhlbHNbaSAqIDQgKyAxXSAtIDEyOCkgKiAkc2NvcGUuY29udHJhc3RJbnQgKyAxMjg7XG5cdFx0XHRcdCRzY29wZS5waXhlbHNbaSAqIDQgKyAyXSA9ICgkc2NvcGUucGl4ZWxzW2kgKiA0ICsgMl0gLSAxMjgpICogJHNjb3BlLmNvbnRyYXN0SW50ICsgMTI4O1xuXHRcdFx0fVxuXHRcdH07XG5cblx0XHR2YXIgcmVzZXRWaWduID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0dmFyIGNuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG5cdFx0XHQvLyBNYWtlIHRoZSBjbiB0aGUgc2FtZSB3aWR0aCBhZG5kIGhlaWdodCBhcyB0aGUgc2FtZSBpbWFnZVxuXHRcdFx0Y24ud2lkdGggPSAkc2NvcGUuaW1hZ2Uud2lkdGg7XG5cdFx0XHRjbi5oZWlnaHQgPSAkc2NvcGUuaW1hZ2UuaGVpZ2h0O1xuXG5cdFx0XHQvLyBHZXQgdGhlIGNvbnRleHQgb2YgY24gICAgICAgICAgICBcblx0XHRcdHZhciBjdHggPSBjbi5nZXRDb250ZXh0KCcyZCcpO1xuXG5cdFx0XHQvLyBEcmF3IHRoZSB2aWduZXR0ZSBpbWFnZSB0byBjdHhcblx0XHRcdGN0eC5kcmF3SW1hZ2UoJHNjb3BlLnZpZ25JbWFnZSwgMCwgMCwgJHNjb3BlLnZpZ25JbWFnZS53aWR0aCwgJHNjb3BlLnZpZ25JbWFnZS5oZWlnaHQsIDAsIDAsIGNuLndpZHRoLCBjbi5oZWlnaHQpO1xuXHRcdFx0JHNjb3BlLnZpZ25EYXRhID0gY3R4LmdldEltYWdlRGF0YSgwLCAwLCBjbi53aWR0aCwgY24uaGVpZ2h0KTsgLy8gR2V0IHRoZSBpbWFnZSBkYXRhIG9mIHRoZSB2aWduZXR0ZVxuXHRcdFx0JHNjb3BlLnZpZ25QaXhlbHMgPSAkc2NvcGUudmlnbkRhdGEuZGF0YTsgLy8gR2V0IHRoZSBwaXhlbHMgZnJvbSBpbWFnZURBVEFcblx0XHR9O1xuXG5cdFx0dmFyIHNldFZpZ25ldHRlID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly9cdFx0XHRjb25zb2xlLmxvZygkc2NvcGUudmlnbkRhdGEuZGF0YSk7XG5cdFx0XHQvLyBQbyA9IFBpICsgUHYgLzI1NTsgIFxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCAkc2NvcGUubnVtUGl4ZWxzOyBpKyspIHtcblx0XHRcdFx0JHNjb3BlLnBpeGVsc1tpICogNF0gPSAkc2NvcGUucGl4ZWxzW2kgKiA0XSAqICRzY29wZS52aWduUGl4ZWxzW2kgKiA0XSAvIDI1NTsgLy8gUmVkXG5cdFx0XHRcdCRzY29wZS5waXhlbHNbaSAqIDQgKyAxXSA9ICRzY29wZS5waXhlbHNbaSAqIDQgKyAxXSAqICRzY29wZS52aWduUGl4ZWxzW2kgKiA0ICsgMV0gLyAyNTU7IC8vIEdyZWVuXG5cdFx0XHRcdCRzY29wZS5waXhlbHNbaSAqIDQgKyAyXSA9ICRzY29wZS5waXhlbHNbaSAqIDQgKyAyXSAqICRzY29wZS52aWduUGl4ZWxzW2kgKiA0ICsgMl0gLyAyNTU7IC8vIEJsdWVcblxuXHRcdFx0fVxuXHRcdH07XG5cblx0XHR2YXIgdGludCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdCRzY29wZS5yZWRJbnQgPSBwYXJzZUludCgkc2NvcGUuY29sb3IucmVkKTtcblx0XHRcdCRzY29wZS5ncmVlbkludCA9IHBhcnNlSW50KCRzY29wZS5jb2xvci5ncmVlbik7XG5cdFx0XHQkc2NvcGUuYmx1ZUludCA9IHBhcnNlSW50KCRzY29wZS5jb2xvci5ibHVlKTtcblx0XHRcdCRzY29wZS5zdHJlbmd0aEludCA9IHBhcnNlSW50KCRzY29wZS5zdHJlbmd0aCk7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS5udW1QaXhlbHM7IGkrKykge1xuXHRcdFx0XHQkc2NvcGUucGl4ZWxzW2kgKiA0XSA9ICRzY29wZS5waXhlbHNbaSAqIDRdICsgJHNjb3BlLmNvbG9yLnJlZCAqICRzY29wZS5zdHJlbmd0aCAvIDEwMDsgLy8gUmVkXG5cdFx0XHRcdCRzY29wZS5waXhlbHNbaSAqIDQgKyAxXSA9ICRzY29wZS5waXhlbHNbaSAqIDQgKyAxXSArICRzY29wZS5jb2xvci5ncmVlbiAqICRzY29wZS5zdHJlbmd0aCAvIDEwMDsgLy8gR3JlZW5cblx0XHRcdFx0JHNjb3BlLnBpeGVsc1tpICogNCArIDJdID0gJHNjb3BlLnBpeGVsc1tpICogNCArIDJdICsgJHNjb3BlLmNvbG9yLmJsdWUgKiAkc2NvcGUuc3RyZW5ndGggLyAxMDA7IC8vIEJsdWVcblxuXHRcdFx0fVxuXHRcdH07XG5cblxuXHRcdC8vXHRcdCRzY29wZS5zZWxlY3QgPSBmdW5jdGlvbiAoaW5kZXgpIHtcblx0XHQvL1x0XHRcdCRzY29wZS5zZWxlY3RlZCA9IGluZGV4O1xuXHRcdC8vXHRcdH07XG5cblxuXHRcdCRzY29wZS5zYXZlSW1hZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHR2YXIgaW1nQXNEYXRhVXJsID0gJHNjb3BlLmNhbnZhcy50b0RhdGFVUkwoJ2ltYWdlcy9wbmcnKTtcblx0XHRcdCRzY29wZS51cmwgPSBpbWdBc0RhdGFVcmw7XG5cblx0XHR9O1xuXG5cdH1cbn0pKCk7Il19
